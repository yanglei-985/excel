<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•è¯å­¦ä¹ å™¨</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="upload-section">
            <h2>å•è¯å­¦ä¹ å™¨</h2>
            <div class="upload-box">
                <input type="file" id="excelFile" accept=".xlsx, .xls">
                <button id="uploadBtn">ä¸Šä¼ Excelæ–‡ä»¶</button>
            </div>
        </div>
            <div>
                <a href="https://grok.com/?referrer=website" target="_blank">Grok</a>
            </div>



        <div class="main-content">
            <div class="study-section" style="display: none;">
                <div class="progress-bar">
                    <div id="progressFill">
                        <div class="progress-handle"></div>
                    </div>
                    <div class="progress-tooltip"></div>
                </div>
                <div class="jump-control">
                    <input type="number" id="jumpInput" min="1" placeholder="è¾“å…¥åºå·">
                    <button id="jumpBtn">è·³è½¬</button>
                </div>
                <div class="stats">
                    <span>è¿›åº¦: <span id="progress">0/0</span></span>
                    <span>æ­£ç¡®ç‡: <span id="accuracy">0%</span></span>
                </div>
                <div class="word-card">
                    <h2 id="word" class="hidden"></h2>
                    <button id="playPronunciation">ğŸ”Š</button>
                    <p id="translation" class="hidden"></p>
                </div>
                <div class="buttons">
                    <button id="showAnswer">æ˜¾ç¤ºç­”æ¡ˆ</button>
                    <button id="nextWord">ä¸‹ä¸€ä¸ª</button>
                    <button id="markWrong">æ ‡è®°ä¸ºé”™é¢˜</button>
                </div>
                <div class="review-options">
                    <button id="shuffleWords">éšæœºé¡ºåº</button>
                    <button id="toggleAutoPlay">å…³é—­è‡ªåŠ¨æ’­æ”¾</button>
                    <button id="resetAll">é‡ç½®æ‰€æœ‰æ•°æ®</button>
                    <button id="exportWords">å¯¼å‡ºæœªæŒæ¡å•è¯</button>
                </div>
                <div class="confusing-words-panel">
                    <details>
                        <summary>æ˜“æ··å•è¯å¯¹æ¯”</summary>
                        <div class="confusing-words-input">
                            <input type="text" id="word1" placeholder="å•è¯1 (ä¾‹: cut)">
                            <input type="text" id="word2" placeholder="å•è¯2 (ä¾‹: cat)">
                            <button id="playComparison">å¯¹æ¯”å‘éŸ³ (å„3æ¬¡)</button>
                        </div>
                    </details>
                </div>
                <div class="loop-play-panel">
                    <h3>å¾ªç¯æ’­æ”¾</h3>
                    <div class="loop-controls">
                        <button id="startLoopPlay">å¼€å§‹å¾ªç¯æ’­æ”¾</button>
                        <input type="number" id="loopInterval" min="1" max="10" value="3" style="width: 50px;">
                        <span>ç§’é—´éš”</span>
                        <div class="loop-status">çŠ¶æ€: <span id="loopStatus">æœªå¼€å§‹</span></div>
                    </div>
                    <script>
                        let loopPlayInterval;
                        let isLooping = false;
                        
                        document.getElementById('startLoopPlay').addEventListener('click', function() {
                            if (!isLooping) {
                                // å¼€å§‹å¾ªç¯æ’­æ”¾
                                const interval = parseInt(document.getElementById('loopInterval').value) * 1000;
                                document.getElementById('loopStatus').textContent = 'æ’­æ”¾ä¸­';
                                document.getElementById('startLoopPlay').textContent = 'åœæ­¢å¾ªç¯æ’­æ”¾';
                                isLooping = true;
                                
                                // ç«‹å³æ’­æ”¾ä¸€æ¬¡
                                playCurrentWordAudio();
                                
                                // è®¾ç½®å¾ªç¯
                                loopPlayInterval = setInterval(playCurrentWordAudio, interval);
                            } else {
                                // åœæ­¢å¾ªç¯æ’­æ”¾
                                clearInterval(loopPlayInterval);
                                document.getElementById('loopStatus').textContent = 'å·²åœæ­¢';
                                document.getElementById('startLoopPlay').textContent = 'å¼€å§‹å¾ªç¯æ’­æ”¾';
                                isLooping = false;
                            }
                        });
                        
                        function playCurrentWordAudio() {
                            // ä½¿ç”¨å·²æœ‰çš„æ’­æ”¾åŠŸèƒ½ï¼ˆé‡ç”¨å·²ç¼“å­˜çš„å‘éŸ³æ–‡ä»¶ï¼‰
                            const playButton = document.getElementById('playPronunciation');
                            if (playButton) {
                                playButton.click(); // è§¦å‘å·²æœ‰çš„æ’­æ”¾æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                            }
                        }
                    </script>
                </div>



                <script>
                    document.getElementById('playComparison').addEventListener('click', function() {
                        const word1 = document.getElementById('word1').value.trim();
                        const word2 = document.getElementById('word2').value.trim();
                        
                        if (!word1 || !word2) {
                            alert("è¯·è¾“å…¥ä¸¤ä¸ªéœ€è¦å¯¹æ¯”çš„å•è¯");
                            return;
                        }
                        
                        playComparison([word1, word2], 3);
                    });
                </script>
            </div>
            
            <div class="history-panel" style="display: none;">
                <h3>æœªæŒæ¡å•è¯</h3>
                <div id="wordHistory"></div>
            </div>
        </div>
    </div>
    <div class="history-panel" style="display: none;">
        <h3>æœªæŒæ¡å•è¯</h3>
        <div id="wordHistory"></div>
    </div>
    
    

    <script src="script1.js"></script>
</body>
</html> 